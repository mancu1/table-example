# –ü–∞–Ω–µ–ª—å –æ—Ç–ª–∞–¥–∫–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

## –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

–†–µ–∞–∫—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å –æ—Ç–ª–∞–¥–∫–∏, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–∞–±–ª–∏—á–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **–ó–∞–ø–æ–ª–Ω–µ–Ω–æ —è—á–µ–µ–∫** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Ö—Ä–∞–Ω—è—â–∏—Ö—Å—è —è—á–µ–µ–∫ –≤ CellStore
- **–î–æ—Å—Ç—É–ø–Ω–æ –ø–æ–∑–∏—Ü–∏–π** - –ª–æ–≥–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–º–µ—Ä –ª–∏—Å—Ç–∞ (—Å—Ç—Ä–æ–∫–∏ √ó —Å—Ç–æ–ª–±—Ü—ã)
- **–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è** - –ø—Ä–æ—Ü–µ–Ω—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —è—á–µ–µ–∫ –æ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
- **–°—Ç—Ä–æ–∫–∏ (ID / —Å–µ–≥–º–µ–Ω—Ç–æ–≤)** - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ ID —Å—Ç—Ä–æ–∫ / –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–≥–º–µ–Ω—Ç–æ–≤
  - –ü—Ä–∏–º–µ—Ä: `100 / 1` –æ–∑–Ω–∞—á–∞–µ—Ç 100 ID –≤ 1 —Å–µ–≥–º–µ–Ω—Ç–µ (–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω)
  - –ü–æ—Å–ª–µ –≤—Å—Ç–∞–≤–æ–∫ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å `105 / 2` (ID —Ä–∞–∑–±–∏—Ç—ã –Ω–∞ 2 —Å–µ–≥–º–µ–Ω—Ç–∞)
- **–°—Ç–æ–ª–±—Ü—ã (ID / —Å–µ–≥–º–µ–Ω—Ç–æ–≤)** - –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è —Å—Ç–æ–ª–±—Ü–æ–≤

**–í–∞–∂–Ω–æ:** –°–µ–≥–º–µ–Ω—Ç—ã - —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ AxisIndex. –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ 1 —Å–µ–≥–º–µ–Ω—Ç —Å –º–∞—Å—Å–∏–≤–æ–º –≤—Å–µ—Ö ID. –ü—Ä–∏ –≤—Å—Ç–∞–≤–∫–∞—Ö/—É–¥–∞–ª–µ–Ω–∏—è—Ö –º–æ–≥—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –Ω–æ–≤—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã, —á—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π O(log S).

### üì¶ –•—Ä–∞–Ω–∏–ª–∏—â–µ —è—á–µ–µ–∫ (CellStore)
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —è—á–µ–π–∫–∏ –≤ –≤–∏–¥–µ JSON:
```json
{
  "A1": {
    "type": "value",
    "value": 10,
    "rowId": "id0",
    "colId": "id0"
  },
  "B2": {
    "type": "formula",
    "formula": "=A1",
    "ast": { "t": "Ref", "ref": {...} },
    "cached": 10,
    "rowId": "id1",
    "colId": "id1"
  }
}
```

–î–ª—è –∫–∞–∂–¥–æ–π —è—á–µ–π–∫–∏ –ø–æ–∫–∞–∑–∞–Ω–æ:
- **type** - `value` –∏–ª–∏ `formula`
- **value** - –∑–Ω–∞—á–µ–Ω–∏–µ (–¥–ª—è value-—è—á–µ–µ–∫)
- **formula** - —Ç–µ–∫—Å—Ç —Ñ–æ—Ä–º—É–ª—ã (–¥–ª—è formula-—è—á–µ–µ–∫)
- **ast** - AST —Ñ–æ—Ä–º—É–ª—ã —Å —è–∫–æ—Ä—è–º–∏
- **cached** - –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª—ã
- **rowId / colId** - —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ ID (–Ω–µ –º–µ–Ω—è—é—Ç—Å—è –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ/—É–¥–∞–ª–µ–Ω–∏–∏)

### üîó –ì—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (DepGraph)
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–≤—è–∑–∏ –º–µ–∂–¥—É —è—á–µ–π–∫–∞–º–∏:
```json
{
  "A1": {
    "dependsOn": [],
    "dependents": ["B2", "C3"]
  },
  "B2": {
    "dependsOn": ["A1"],
    "dependents": []
  }
}
```

- **dependsOn** - –æ—Ç –∫–∞–∫–∏—Ö —è—á–µ–µ–∫ –∑–∞–≤–∏—Å–∏—Ç –¥–∞–Ω–Ω–∞—è —è—á–µ–π–∫–∞
- **dependents** - –∫–∞–∫–∏–µ —è—á–µ–π–∫–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –¥–∞–Ω–Ω–æ–π —è—á–µ–π–∫–∏

### üóÇÔ∏è –ò–Ω–¥–µ–∫—Å—ã –ø–æ–∑–∏—Ü–∏–π (AxisIndex)
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Å—Ç—Ä–æ–∫ –∏ —Å—Ç–æ–ª–±—Ü–æ–≤:
```json
{
  "rows": [
    {
      "startPos": 1,
      "count": 100,
      "ids": ["id0", "id1", "id2", "id3", "id4", "..."]
    }
  ],
  "cols": [
    {
      "startPos": 1,
      "count": 26,
      "ids": ["id0", "id1", "id2", "id3", "id4", "..."]
    }
  ]
}
```

- **startPos** - –Ω–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è —Å–µ–≥–º–µ–Ω—Ç–∞ (1-based)
- **count** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ ID –≤ —Å–µ–≥–º–µ–Ω—Ç–µ
- **ids** - –ø–µ—Ä–≤—ã–µ 5 ID –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞

–ü—Ä–∏ –≤—Å—Ç–∞–≤–∫–∞—Ö/—É–¥–∞–ª–µ–Ω–∏—è—Ö –º–æ–≥—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –Ω–æ–≤—ã–µ —Å–µ–≥–º–µ–Ω—Ç—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä:
```json
{
  "rows": [
    {
      "startPos": 1,
      "count": 50,
      "ids": ["id0", "id1", "..."]
    },
    {
      "startPos": 51,
      "count": 55,
      "ids": ["id100", "id101", "..."]
    }
  ]
}
```
–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Å—Ç—Ä–æ–∫–∏ 1-50 –∏—Å–ø–æ–ª—å–∑—É—é—Ç ID –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞, –∞ —Å—Ç—Ä–æ–∫–∏ 51-105 - –∏–∑ –≤—Ç–æ—Ä–æ–≥–æ.

## –†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

–ü–∞–Ω–µ–ª—å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏:
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–æ—Ä–º—É–ª—ã
- –í—Å—Ç–∞–≤–∫–∞ —Å—Ç—Ä–æ–∫/—Å—Ç–æ–ª–±—Ü–æ–≤
- –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫/—Å—Ç–æ–ª–±—Ü–æ–≤

## –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ:
1. –°–æ–∑–¥–∞–π—Ç–µ –ª–∏—Å—Ç 100√ó26 (–ª–æ–≥–∏—á–µ—Å–∫–∏ 2600 —è—á–µ–µ–∫)
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ 3 —è—á–µ–π–∫–∏
3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:
   - –ó–∞–ø–æ–ª–Ω–µ–Ω–æ: 3
   - –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è: 0.115%
   - –í JSON –≤–∏–¥–Ω—ã —Ç–æ–ª—å–∫–æ 3 —è—á–µ–π–∫–∏!

## –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö ID

1. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ A1 = 10
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ `rowId` –∏ `colId` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `id0` –∏ `id0`)
3. –í—Å—Ç–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É –ø–µ—Ä–µ–¥ A1
4. –Ø—á–µ–π–∫–∞ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—Å—è –≤ A2, –Ω–æ ID –æ—Å—Ç–∞–Ω—É—Ç—Å—è —Ç–µ–º–∏ –∂–µ!

## –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

1. A1 = 10
2. B1 = =A1
3. C1 = =SUM(A1:B1)
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –≥—Ä–∞—Ñ:
   - A1 –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –Ω–∏ –æ—Ç –∫–æ–≥–æ, –Ω–æ –æ—Ç –Ω–µ—ë –∑–∞–≤–∏—Å—è—Ç B1 –∏ C1
   - B1 –∑–∞–≤–∏—Å–∏—Ç –æ—Ç A1
   - C1 –∑–∞–≤–∏—Å–∏—Ç –æ—Ç A1 –∏ B1

## –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è

- **–¢—ë–º–Ω–∞—è —Ç–µ–º–∞** –¥–ª—è JSON (–∫–∞–∫ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –∫–æ–¥–∞)
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** –≤ –≤–∏–¥–µ –∫—Ä–∞—Å–∏–≤—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
- **–°–∫—Ä–æ–ª–ª–∏—Ä—É–µ–º—ã–µ –±–ª–æ–∫–∏** –¥–ª—è –±–æ–ª—å—à–∏—Ö JSON'–æ–≤ (max-height: 500px)
- **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω** –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:
- `src/ui.ts` - –¥–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `getDebugState()` –∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –ø–∞–Ω–µ–ª–∏
- `styles.css` - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å—Ç–∏–ª–∏ –¥–ª—è `.debug-panel`, `.debug-section`, `.debug-json`
- `index.html` - —É–±—Ä–∞–Ω–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–∫—Ü–∏—è `.info`

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–µ
- JSON.stringify –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ
- –î–ª—è –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü (—Ç—ã—Å—è—á–∏ —è—á–µ–µ–∫) –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–∏–º–∏—Ç –∏–ª–∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—é

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü—É—Å—Ç–∞—è —Ç–∞–±–ª–∏—Ü–∞
```json
{
  "cells": {},
  "dependencies": {},
  "stats": {
    "totalCells": 0,
    "maxRow": 100,
    "maxCol": 26,
    ...
  }
}
```

### –ü—Ä–∏–º–µ—Ä 2: –° —Ñ–æ—Ä–º—É–ª–∞–º–∏
–ù–∞–∂–º–∏—Ç–µ "–ü—Ä–∏–º–µ—Ä 3" –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∫–∞–∫:
- –í `cells` –ø–æ—è–≤–ª—è—é—Ç—Å—è A3, B3, C3, A4, B4, C4, A5
- –í `dependencies` –≤–∏–¥–Ω–æ —á—Ç–æ A5 –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—Å–µ—Ö —è—á–µ–µ–∫ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ
- `cached` –∑–Ω–∞—á–µ–Ω–∏–µ –≤ A5 = 21 (—Å—É–º–º–∞ 1+2+3+4+5+6)

### –ü—Ä–∏–º–µ—Ä 3: –ü–æ—Å–ª–µ –≤—Å—Ç–∞–≤–∫–∏ —Å—Ç–æ–ª–±—Ü–∞
1. –°–æ–∑–¥–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä–æ–º 3
2. –í—Å—Ç–∞–≤—å—Ç–µ —Å—Ç–æ–ª–±–µ—Ü –º–µ–∂–¥—É B –∏ C
3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –∫–∞–∫:
   - `rowId` –∏ `colId` –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —è—á–µ–µ–∫
   - –§–æ—Ä–º—É–ª–∞ –≤ A5 —Ä–∞—Å—à–∏—Ä–∏–ª–∞—Å—å –Ω–∞ –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü
   - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–∏–ª–∏—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

–≠—Ç–∞ –ø–∞–Ω–µ–ª—å - –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Ä–∞–±–æ—Ç—ã —Ç–∞–±–ª–∏—á–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è!

