# –¢–∞–±–ª–∏—á–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä —Å —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–º —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º

–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –¥–ª—è –æ—Ñ–∏—Å–Ω–æ–≥–æ —Ç–∞–±–ª–∏—á–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–µ–≥–æ –¥–æ 1 000 000 √ó 16 000 —è—á–µ–µ–∫ —Å –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–º –ø–µ—Ä–µ—Å—á–µ—Ç–æ–º —Ñ–æ—Ä–º—É–ª.

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–†–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ**: –ø–∞–º—è—Ç—å —Ä–∞—Å—Ç–µ—Ç —Ç–æ–ª—å–∫–æ –æ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —è—á–µ–µ–∫, –∞ –Ω–µ –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ª–∏—Å—Ç–∞
- **–°—Ç–∞–±–∏–ª—å–Ω—ã–µ ID**: —è—á–µ–π–∫–∏ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º RowId/ColId
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**: –≤—Å—Ç–∞–≤–∫–∞/—É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ –∏ —Å—Ç–æ–ª–±—Ü–æ–≤ –±–µ–∑ –º–∞—Å—Å–æ–≤–æ–≥–æ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è
- **–§–æ—Ä–º—É–ª—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Å—Å—ã–ª–∫–∞–º–∏**: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö (=A1) –∏ –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö (=$B$2) —Å—Å—ã–ª–æ–∫
- **–î–∏–∞–ø–∞–∑–æ–Ω—ã —Å –ø–æ–ª–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π $**: =SUM(A1:C3), =SUM($A$1:$C$3), =SUM($A1:C$3) –∏ –≤—Å–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
- **–ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —è–∫–æ—Ä—è**: –Ω–∞—á–∞–ª–æ –∏ –∫–æ–Ω–µ—Ü –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Ä–∞–∑–Ω—ã–µ —Ä–µ–∂–∏–º—ã (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π/–∞–±—Å–æ–ª—é—Ç–Ω—ã–π)
- **–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ—Å—á–µ—Ç**: –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–æ—Ä–º—É–ª—ã
- **–î–µ—Ç–µ–∫—Ü–∏—è —Ü–∏–∫–ª–æ–≤**: —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏ –ø–æ–º–µ—á–∞—é—Ç—Å—è #CYCLE!
- **–ì—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–µ–∂–¥—É —è—á–µ–π–∫–∞–º–∏
- **–†–µ–∞–∫—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å –æ—Ç–ª–∞–¥–∫–∏**: –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è

–†–∞–∑–¥–µ–ª—è–µ–º –ª–æ–≥–∏–∫—É –ø–æ–∑–∏—Ü–∏–π –∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ ID:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç **–ø–æ–∑–∏—Ü–∏–∏** (1...N)
- –Ø—á–µ–π–∫–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ **–Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º RowId/ColId**
- –í—Å—Ç–∞–≤–∫–∏/—É–¥–∞–ª–µ–Ω–∏—è –º–µ–Ω—è—é—Ç —Ç–æ–ª—å–∫–æ –∏–Ω–¥–µ–∫—Å—ã –ø–æ–∑–∏—Ü–∏–π
- –°—Å—ã–ª–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –∫–∞–∫ **—è–∫–æ—Ä—è** (anchors) —Å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–º–∏/–∞–±—Å–æ–ª—é—Ç–Ω—ã–º–∏ —Å–º–µ—â–µ–Ω–∏—è–º–∏

üìö **–ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:** —Å–º. [ARCHITECTURE.md](ARCHITECTURE.md)
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –æ–ø–µ—Ä–∞—Ü–∏–π
- –ê–ª–≥–æ—Ä–∏—Ç–º—ã –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å
- –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã –≥—Ä–∞—Ñ–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### `CellStore`
–†–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —è—á–µ–µ–∫ –Ω–∞ –±–∞–∑–µ Map. –•—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —è—á–µ–π–∫–∏.

#### `AxisIndex`
–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–π: –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏—è ‚Üî ID –∑–∞ O(log S), –≥–¥–µ S ‚Äî —á–∏—Å–ª–æ —Å–µ–≥–º–µ–Ω—Ç–æ–≤.

#### `DepGraph`
–ì—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –ø–µ—Ä–µ—Å—á–µ—Ç–∞. –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç, –∫–∞–∫–∏–µ —Ñ–æ—Ä–º—É–ª—ã –∑–∞–≤–∏—Å—è—Ç –æ—Ç –∫–∞–∫–∏—Ö —è—á–µ–µ–∫.

#### `RangeWatchers`
–ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π —Ç–∏–ø–∞ SUM. –û—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–∞—Ö.

#### `Parser`
–ü–∞—Ä—Å–∏–Ω–≥ —Ñ–æ—Ä–º—É–ª: =A1, =$B$2, =SUM(A1:C3). –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ AST —Å —è–∫–æ—Ä—è–º–∏.

#### `Transform`
–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è —è–∫–æ—Ä–µ–π –∏ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –ø—Ä–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö.

### –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

```typescript
// –Ø–∫–æ—Ä—å —Å—Å—ã–ª–∫–∏
type Anchor = {
  base: Address;           // –≥–¥–µ —Å—Ç–æ–∏—Ç —Ñ–æ—Ä–º—É–ª–∞
  rowMode: 'rel' | 'abs';
  colMode: 'rel' | 'abs';
  dRow: number;            // —Å–º–µ—â–µ–Ω–∏–µ –æ—Ç base
  dCol: number;
};

// –§–æ—Ä–º—É–ª–∞
type Formula =
  | { t: 'Ref'; ref: Anchor }
  | { t: 'Sum'; range: RangeRef };

// –Ø—á–µ–π–∫–∞
type Cell =
  | { kind: 'value'; value: number | '#REF!' | '#CYCLE!' }
  | { kind: 'formula'; ast: Formula; cached?: Scalar };
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npm install
```

### –°–±–æ—Ä–∫–∞

```bash
npm run build
```

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å hot reload

```bash
npm run serve
```

–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –Ω–∞ http://localhost:9000

## üìñ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

```typescript
import { Table } from './src/sheet';

const table = new Table(100, 26);

// –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ
table.setValue({ r: 1, c: 1 }, 42);

// –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–æ—Ä–º—É–ª—É
table.setFormula({ r: 2, c: 1 }, '=A1');
table.setFormula({ r: 3, c: 1 }, '=$A$1');
table.setFormula({ r: 4, c: 1 }, '=SUM(A1:A3)');

// –ü–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ
const value = table.getValue({ r: 1, c: 1 }); // 42

// –°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
table.insertRows(5, 3);     // –≤—Å—Ç–∞–≤–∏—Ç—å 3 —Å—Ç—Ä–æ–∫–∏ –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ 5
table.deleteRows(10, 12);   // —É–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ 10-12
table.insertCols(3, 1);     // –≤—Å—Ç–∞–≤–∏—Ç—å 1 —Å—Ç–æ–ª–±–µ—Ü –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ 3
table.deleteCols(5, 5);     // —É–¥–∞–ª–∏—Ç—å —Å—Ç–æ–ª–±–µ—Ü 5
```

### –ü—Ä–∏–º–µ—Ä—ã —Ñ–æ—Ä–º—É–ª

#### –ü—Ä–æ—Å—Ç—ã–µ —Å—Å—ã–ª–∫–∏
- `=A1` - –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ (—Å–¥–≤–∏–≥–∞–µ—Ç—Å—è –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ)
- `=$A$1` - –∞–±—Å–æ–ª—é—Ç–Ω–∞—è —Å—Å—ã–ª–∫–∞ (–Ω–µ —Å–¥–≤–∏–≥–∞–µ—Ç—Å—è)
- `=$B2` - —Å—Ç–æ–ª–±–µ—Ü –∞–±—Å–æ–ª—é—Ç–Ω—ã–π, —Å—Ç—Ä–æ–∫–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è
- `=A$5` - —Å—Ç–æ–ª–±–µ—Ü –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π, —Å—Ç—Ä–æ–∫–∞ –∞–±—Å–æ–ª—é—Ç–Ω–∞—è

#### –î–∏–∞–ø–∞–∑–æ–Ω—ã SUM
- `=SUM(A1:C3)` - –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω (—Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ)
- `=SUM($A$1:$C$3)` - –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã)
- `=SUM($A1:$C3)` - —Å—Ç–æ–ª–±—Ü—ã –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ, —Å—Ç—Ä–æ–∫–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ
- `=SUM(A$1:C$3)` - —Å—Ç—Ä–æ–∫–∏ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ, —Å—Ç–æ–ª–±—Ü—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ
- `=SUM($A$1:C3)` - –Ω–∞—á–∞–ª–æ –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ, –∫–æ–Ω–µ—Ü –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤—Å–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏!** –°–º. [ABSOLUTE_RANGES.md](ABSOLUTE_RANGES.md) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.

### –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö

#### –í—Å—Ç–∞–≤–∫–∞ —Å—Ç—Ä–æ–∫

```
–î–æ:          –ü–æ—Å–ª–µ –≤—Å—Ç–∞–≤–∫–∏ 2 —Å—Ç—Ä–æ–∫ –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ 2:
A1: 10       A1: 10
A2: =A1      A2: (–ø—É—Å—Ç–æ)
A3: 20       A3: (–ø—É—Å—Ç–æ)
             A4: =A1      (—Ñ–æ—Ä–º—É–ª–∞ —Å–¥–≤–∏–Ω—É–ª–∞—Å—å)
             A5: 20       (–∑–Ω–∞—á–µ–Ω–∏–µ —Å–¥–≤–∏–Ω—É–ª–æ—Å—å)
```

#### –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞

```
–î–æ:                      –ü–æ—Å–ª–µ –≤—Å—Ç–∞–≤–∫–∏ —Å—Ç—Ä–æ–∫–∏ 2:
A1: 1                    A1: 1
A2: 2                    A2: (–ø—É—Å—Ç–æ)
A3: 3                    A3: 2
A4: =SUM(A1:A3)  ‚Üí 6     A4: 3
                         A5: =SUM(A1:A4)  ‚Üí 6  (–¥–∏–∞–ø–∞–∑–æ–Ω —Ä–∞—Å—à–∏—Ä–∏–ª—Å—è!)
```

## üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

1. **–†–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ—Å—Ç—å**: —Å–æ–∑–¥–∞—Ç—å –ª–∏—Å—Ç 1M√ó16K, –∑–∞–ø–æ–ª–Ω–∏—Ç—å 100K —è—á–µ–µ–∫ - –ø–∞–º—è—Ç—å ~O(100K)
2. **–í—Å—Ç–∞–≤–∫–∞**: –≤—Å—Ç–∞–≤–∏—Ç—å 1000 —Å—Ç—Ä–æ–∫ - —Ç–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –∏ —è–∫–æ—Ä–µ–π
3. **–§–æ—Ä–º—É–ª—ã**: –∏–∑–º–µ–Ω–µ–Ω–∏–µ A1 –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∑–∞–≤–∏—Å–∏–º—ã–µ —Ñ–æ—Ä–º—É–ª—ã
4. **–¶–∏–∫–ª—ã**: =A1 –≤ B1, =B1 –≤ A1 ‚Üí –æ–±–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç #CYCLE!
5. **SUM**: –∏–∑–º–µ–Ω–µ–Ω–∏–µ —è—á–µ–π–∫–∏ –≤–Ω—É—Ç—Ä–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç SUM

## üìä –ê—Å–∏–º–ø—Ç–æ—Ç–∏–∫–∏

- **–î–æ—Å—Ç—É–ø –∫ —è—á–µ–π–∫–µ**: O(1) –ø–æ CellStore + O(log S) –Ω–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π
- **–í—Å—Ç–∞–≤–∫–∞/—É–¥–∞–ª–µ–Ω–∏–µ**: O(log S) –Ω–∞ –∏–Ω–¥–µ–∫—Å + O(F) –Ω–∞ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–æ—Ä–º—É–ª—ã
- **–ü–µ—Ä–µ—Å—á–µ—Ç**: O(|affected| + |edges|) –ø–æ –≥—Ä–∞—Ñ—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- **SUM**: O(filled cells) –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ, –Ω–µ O(range size)
- **–ü–∞–º—è—Ç—å**: O(filled cells + formulas + dependencies)

–≥–¥–µ:
- S ‚Äî —á–∏—Å–ª–æ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –≤ –∏–Ω–¥–µ–∫—Å–µ (–æ–±—ã—á–Ω–æ << —Ä–∞–∑–º–µ—Ä–∞ –ª–∏—Å—Ç–∞)
- F ‚Äî —á–∏—Å–ª–æ —Ñ–æ—Ä–º—É–ª, —á—å–∏ —Å—Å—ã–ª–∫–∏ –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–µ–π

## üé® UI

–ü—Ä–æ—Å—Ç–æ–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏:
- –¢–∞–±–ª–∏—Ü–∞ —Å input-–ø–æ–ª—è–º–∏
- –ö–Ω–æ–ø–∫–∏ –≤—Å—Ç–∞–≤–∫–∏/—É–¥–∞–ª–µ–Ω–∏—è —Å—Ç—Ä–æ–∫ –∏ —Å—Ç–æ–ª–±—Ü–æ–≤
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —è—á–µ–π–∫–∏ –∏ –µ—ë –∑–Ω–∞—á–µ–Ω–∏—è
- –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞

### üîç –ü–∞–Ω–µ–ª—å –æ—Ç–ª–∞–¥–∫–∏ (Debug Panel)

**–†–µ–∞–∫—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å**, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∞—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:

- **üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —è—á–µ–µ–∫, –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è, —Å–µ–≥–º–µ–Ω—Ç—ã
- **üì¶ CellStore**: –≤—Å–µ —Ö—Ä–∞–Ω—è—â–∏–µ—Å—è —è—á–µ–π–∫–∏ —Å –∏—Ö ID –∏ —Ñ–æ—Ä–º—É–ª–∞–º–∏
- **üîó DepGraph**: –≥—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–µ–∂–¥—É —è—á–µ–π–∫–∞–º–∏

–û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö - –Ω–∞–≥–ª—è–¥–Ω–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö ID!

–°–º. [DEBUG_PANEL.md](DEBUG_PANEL.md) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.

## üîß –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ types.ts          # –ë–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã
‚îÇ   ‚îú‚îÄ‚îÄ cell-store.ts     # –†–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
‚îÇ   ‚îú‚îÄ‚îÄ axis-index.ts     # –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ dep-graph.ts      # –ì—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ range-watchers.ts # –ù–∞–±–ª—é–¥–∞—Ç–µ–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ parser.ts         # –ü–∞—Ä—Å–µ—Ä —Ñ–æ—Ä–º—É–ª
‚îÇ   ‚îú‚îÄ‚îÄ transform.ts      # –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ —è–∫–æ—Ä–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ sheet.ts          # Sheet –∏ Table
‚îÇ   ‚îú‚îÄ‚îÄ ui.ts             # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚îÇ   ‚îî‚îÄ‚îÄ main.ts           # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ index.html
‚îú‚îÄ‚îÄ styles.css
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îú‚îÄ‚îÄ webpack.config.js
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ ARCHITECTURE.md       # üìö –ü–æ–ª–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
‚îú‚îÄ‚îÄ CHANGELOG.md          # –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
‚îú‚îÄ‚îÄ DEBUG_PANEL.md        # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–∞–Ω–µ–ª–∏ –æ—Ç–ª–∞–¥–∫–∏
‚îú‚îÄ‚îÄ SEGMENTS_EXPLAINED.md # –û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –≤ AxisIndex
‚îî‚îÄ‚îÄ ABSOLUTE_RANGES.md    # –ê–±—Å–æ–ª—é—Ç–Ω—ã–µ –∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã
```

## üìù –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- –û–¥–∏–Ω –ª–∏—Å—Ç (–º—É–ª—å—Ç–∏-–ª–∏—Å—Ç—ã –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã)
- –¢–æ–ª—å–∫–æ —á–∏—Å–ª–∞ (–Ω–µ—Ç —Å—Ç—Ä–æ–∫, –¥–∞—Ç, –±—É–ª–µ–≤—ã—Ö)
- –¢—Ä–∏ —Ç–∏–ø–∞ —Ñ–æ—Ä–º—É–ª (Ref, –∞–±—Å–æ–ª—é—Ç–Ω—ã–π Ref, SUM)
- –ù–µ—Ç —Ñ—É–Ω–∫—Ü–∏–π MIN/MAX/AVERAGE/IF –∏ —Ç.–¥.
- –ù–µ—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ù–µ—Ç –æ—Ç–º–µ–Ω—ã/–ø–æ–≤—Ç–æ—Ä–∞ (undo/redo)
- –ë–∞–∑–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## üöÄ –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–ë–æ–ª—å—à–µ —Ñ—É–Ω–∫—Ü–∏–π**: MIN, MAX, AVERAGE, COUNT, IF, VLOOKUP
2. **–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö**: —Å—Ç—Ä–æ–∫–∏, –¥–∞—Ç—ã, –±—É–ª–µ–≤—ã–µ
3. **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: —á–∏—Å–ª–∞, –¥–∞—Ç—ã, –≤–∞–ª—é—Ç–∞
4. **–ú—É–ª—å—Ç–∏-–ª–∏—Å—Ç—ã**: —Å—Å—ã–ª–∫–∏ –º–µ–∂–¥—É –ª–∏—Å—Ç–∞–º–∏
5. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è AxisIndex**: —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –¥–µ—Ä–µ–≤–æ –≤–º–µ—Å—Ç–æ –º–∞—Å—Å–∏–≤–∞ —Å–µ–≥–º–µ–Ω—Ç–æ–≤
6. **–í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∞**: –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü
7. **Undo/Redo**: –∏—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
8. **–°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è**: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞ –≤ —Ñ–∞–π–ª
9. **–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ/–≤—Å—Ç–∞–≤–∫–∞**: —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–µ–π —Å—Å—ã–ª–æ–∫
10. **–ò–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã**: –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

